<script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
<script src='https://dl.dropboxusercontent.com/u/95890750/set/set.js'></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>

<body>
    <h1> Set! </h1>
    <p><a href='/livegame1'>click here to play two player game</a></p>
    <p><a href='/oneplayer'>click here to play timed one player game</a></p>
    <p><a href='/besttime'> click to see best time</a></p>
    <div id='counter'></div>
    
    <script>
    for (var i=0; i<10; i++){
        newp = dom('P', {id: i});
        $('#counter').append(newp);

    }
    function forEachIn(object, func) {
        for (var property in object) {
            if (object.hasOwnProperty(property))
                func(property, object[property])
        }
    }
    var socket = io('/');
    var gameStatus = {};
    var games = [];
    for (var i=0; i<10; i++){
        games.push('livegame' + i);
    }
    games.forEach(function(current){
        gameStatus[current] = 'no players';
    });
    socket.on('player joined game', function(visitCounter){
        var gamesWaiting = [];
        var gamesHappening = [];
        forEachIn(visitCounter, function(prop, val){
            if (val === 1 && prop !== ''){
                gameStatus[prop] = 'player waiting';
                //gamesWaiting.push(prop);
            }
            else if (val === 2 && prop !== ''){
                gameStatus[prop] = 'game in progress';
                //gamesHappening.push(prop);
            }
        });
        console.log(gamesWaiting);
        for (var i=0; i<10; i++){
            var p = $('#' + String(i));
            p.text('/livegame' + String(i) + ': ' + gameStatus['livegame' + String(i)]);
        }
        // gamesWaiting.forEach(function(current){
        //     $('#counter').append($('<li>').text('game waiting for another player at /' + current));
        // });
        // gamesHappening.forEach(function(current){
        //     $('#counter').append($('<li>').text('two player game happening at /' + current));
        // });
    socket.on('player left game', function(visitCounter){

    })
        
        
        
    })
    </script>

</body>